<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Wave Cafe - Manager</title>
  <link rel="stylesheet" href="fontawesome/css/all.min.css">
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400" rel="stylesheet" />
  <link rel="stylesheet" href="css/tooplate-wave-cafe.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>
  <div class="tm-container">
    <div class="tm-row">
      <div class="tm-left">
        <div class="tm-left-inner">
          <div class="tm-site-header">
            <i class="fas fa-user-cog fa-3x tm-site-logo"></i>
            <h1 class="tm-site-name">Manager Panel</h1>
          </div>
        </div>
      </div>
      <div class="tm-right">
        <main class="tm-main">
          <div class="tm-page-content">
            <h2 class="tm-text-primary text-center mb-4">Quản lý hóa đơn</h2>

            <!-- Secret Code -->
            <div class="d-flex justify-content-between mb-3">
              <button id="generateSecretCode" class="btn btn-danger">Generate Secret Code</button>
              <span id="secretCodeDisplay" class="font-weight-bold text-danger" style="font-size: 20px;"></span>
            </div>

            <!-- Danh sách hóa đơn -->
            <div class="table-responsive">
              <table class="table table-striped table-hover">
                <thead class="thead-dark">
                  <tr>
                    <th>ID</th>
                    <th>Bàn</th>
                    <th>Món đã gọi</th>
                    <th>Tổng tiền</th>
                    <th>Thời gian mở bàn → Thanh toán</th>
                    <th>Hành động</th>
                  </tr>
                </thead>
                <tbody id="orderManagerList">
                  <!-- Hóa đơn sẽ hiển thị tại đây -->
                </tbody>
              </table>
            </div>
          </div>
        </main>
      </div>
    </div>
  </div>
 <!-- Background video -->
 <div class="tm-video-wrapper">
    <i id="tm-video-control-button" class="fas fa-pause"></i>
    <video autoplay muted loop id="tm-video">
        <source src="video/wave-cafe-video-bg.mp4" type="video/mp4">
    </video>
</div>
  <script>
    $(document).ready(function () {
      $(".deleteBill").click(function () {
        let billId = $(this).data("id");
        $("#bill-" + billId).fadeOut(300, function () {
          $(this).remove();
        });
      });

      let lastGeneratedTime = 0;
      const cooldownTime = 10 * 60 * 1000;

      $("#generateSecretCode").click(function () {
        let currentTime = new Date().getTime();
        if (currentTime - lastGeneratedTime >= cooldownTime) {
          let secretCode = Math.floor(1000 + Math.random() * 9000);
          $("#secretCodeDisplay").text("Secret Code: " + secretCode);
          lastGeneratedTime = currentTime;
          $(this).prop("disabled", true);
          startCooldownTimer();
        } else {
          let remainingTime = Math.ceil((cooldownTime - (currentTime - lastGeneratedTime)) / 1000);
          let minutes = Math.floor(remainingTime / 60);
          let seconds = remainingTime % 60;
          $("#secretCodeDisplay").text(`Chờ ${minutes} phút ${seconds} giây để tạo mã mới.`);
        }
      });

      function startCooldownTimer() {
        let interval = setInterval(function () {
          let currentTime = new Date().getTime();
          let remainingTime = Math.ceil((cooldownTime - (currentTime - lastGeneratedTime)) / 1000);

          if (remainingTime <= 0) {
            clearInterval(interval);
            $("#generateSecretCode").prop("disabled", false);
            $("#secretCodeDisplay").text("");
          }
        }, 1000);
      }
    });
  </script>
</body>
</html>