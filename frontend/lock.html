<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kh√≥a B√†n - Wave Cafe</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
      <div id="lockScreen" class="lock-container">
          <h2 class="tm-text-primary text-center mb-4">üîí M·ªü kh√≥a b√†n</h2>
  
          <div class="form-group">
              <label for="tableSelect">Ch·ªçn b√†n:</label>
              <select id="tableSelect" class="form-control">
                  <option value="">Ch·ªçn s·ªë b√†n...</option>
                  <option value="101">B√†n 101</option>
                  <option value="102">B√†n 102</option>
                  <option value="103">B√†n 103</option>
                  <option value="104">B√†n 104</option>
              </select>
          </div>
  
          <div class="form-group">
              <label for="secretCodeInput">Nh·∫≠p Secret Code:</label>
              <input type="password" id="secretCodeInput" class="form-control" placeholder="Nh·∫≠p m√£ x√°c nh·∫≠n">
              <p id="errorMsg" class="text-danger mt-2" style="display: none;">M√£ ho·∫∑c s·ªë b√†n kh√¥ng ƒë√∫ng!</p>
          </div>
  
          <button id="unlockTableBtn" class="btn btn-primary btn-block">M·ªü kh√≥a</button>
      </div>
  </body>
  
</html>

<style>
      body {
            font-family: Arial, sans-serif;
            background: url('img/lockscreen.jpg') no-repeat center center fixed;
            background-size: cover;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            margin: 0;
        }
        
        body::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5); /* T·∫°o hi·ªáu ·ª©ng t·ªëi */
            backdrop-filter: blur(5px); /* L√†m m·ªù n·ªÅn */
            z-index: 1;
        }
        
        .lock-container {
            width: 350px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.9); /* L√†m m·ªù form nh·∫≠p */
            border-radius: 10px;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.2);
            text-align: center;
            position: relative;
            z-index: 2;
        }
        
        .tm-container {
            max-width: 800px;
            margin: auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.2);
        }
        
        .tm-site-header {
            text-align: center;
            padding: 20px;
        }
        
        .tm-site-nav {
            background: #007bff;
            padding: 10px;
        }
        
        .tm-site-nav-ul {
            list-style: none;
            padding: 0;
            display: flex;
            justify-content: space-around;
        }
        
        .tm-site-nav-ul li a {
            color: white;
            text-decoration: none;
        }
        
        .tm-text-primary {
            color: #007bff;
        }
        
</style>
<script>
       $(document).ready(function () {
  const role = localStorage.getItem("role");
  const token = localStorage.getItem("token");

  if (!token || role !== "waiter") {
    return window.location.href = "login.html";
  }

  // X√°c minh m√£
  $("#unlockTableBtn").click(async function () {
    const selectedTable = $("#tableSelect").val();
    const secretCode = $("#secretCodeInput").val();

    const res = await fetch("http://localhost:3005/api/secret/verify", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        Authorization: "Bearer " + token,
      },
      body: JSON.stringify({ code: secretCode }),
    });

    const data = await res.json();
    if (data.status === "success" && data.metaData === true) {
      sessionStorage.setItem("tableNumber", selectedTable);
      localStorage.setItem("verifiedCode", "true");
      window.location.href = "waiter.html";
    } else {
      $("#errorMsg").text("M√£ kh√¥ng ƒë√∫ng!").show();
    }
  });
});

    
</script>
    